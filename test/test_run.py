"""
Ibutsu API

A system to store and query test results

The version of the OpenAPI document: 2.8.3
Generated by OpenAPI Generator (https://openapi-generator.tech)

Do not edit the class manually.
"""

import json
from uuid import uuid4

from ibutsu_client.models.run import Run


class TestRun:
    """Run model tests"""

    def test_run_creation_empty(self):
        """Test Run creation with no parameters"""
        run = Run()
        assert run.id is None
        assert run.source is None

    def test_run_creation_with_required(self):
        """Test Run creation with required params only (none are strictly required in init)"""
        run = Run(source="test_source")
        assert run.source == "test_source"

    def test_run_creation_full(self):
        """Test Run creation with all parameters"""
        run_id = uuid4()
        project_id = uuid4()

        run = Run(
            id=run_id,
            created="2023-01-01T12:00:00Z",
            duration=100.5,
            source="jenkins",
            start_time="2023-01-01T11:00:00Z",
            component="backend",
            env="prod",
            project_id=project_id,
            summary={"passed": 10, "failed": 0},
            metadata={"key": "value"},
        )

        assert run.id == run_id
        assert run.source == "jenkins"
        assert run.duration == 100.5
        assert run.component == "backend"
        assert run.metadata == {"key": "value"}

    def test_run_to_dict(self):
        """Test Run to_dict conversion"""
        run = Run(source="test_dict", component="comp")
        run_dict = run.to_dict()

        assert isinstance(run_dict, dict)
        assert run_dict["source"] == "test_dict"
        assert run_dict["component"] == "comp"

    def test_run_to_json(self):
        """Test Run to_json conversion"""
        run = Run(source="test_json")
        run_json = run.to_json()

        assert isinstance(run_json, str)
        parsed = json.loads(run_json)
        assert parsed["source"] == "test_json"

    def test_run_from_dict(self):
        """Test Run from_dict creation"""
        run_dict = {"source": "test_from_dict", "component": "comp_from_dict"}
        run = Run.from_dict(run_dict)

        assert isinstance(run, Run)
        assert run.source == "test_from_dict"
        assert run.component == "comp_from_dict"

    def test_run_from_json(self):
        """Test Run from_json creation"""
        run_json = '{"source": "test_from_json"}'
        run = Run.from_json(run_json)

        assert isinstance(run, Run)
        assert run.source == "test_from_json"

    def test_run_to_str(self):
        """Test Run to_str representation"""
        run = Run(source="test_str")
        run_str = run.to_str()

        assert isinstance(run_str, str)
        assert "test_str" in run_str

    def test_run_none_values_excluded(self):
        """Test that None values are excluded from dict"""
        run = Run(source="test_none")
        run_dict = run.to_dict()

        assert "source" in run_dict
        assert "duration" not in run_dict

    def test_run_explicit_nones(self):
        """Test explicit None values are preserved in to_dict if set"""
        run = Run(source=None, component=None, env=None, project_id=None, metadata=None)
        run_dict = run.to_dict()

        assert "source" in run_dict
        assert run_dict["source"] is None
        assert "component" in run_dict
        assert run_dict["component"] is None
        assert "env" in run_dict
        assert run_dict["env"] is None
        assert "project_id" in run_dict
        assert run_dict["project_id"] is None
        assert "metadata" in run_dict
        assert run_dict["metadata"] is None

    def test_run_from_dict_none(self):
        """Test Run.from_dict with None returns None"""
        run = Run.from_dict(None)
        assert run is None

    def test_run_from_dict_non_dict(self):
        """Test from_dict with a non-dict object"""
        run_obj = Run(source="test_obj")
        new_run = Run.from_dict(run_obj)
        assert new_run.source == "test_obj"

    def test_run_roundtrip_json(self):
        """Test Run can be serialized and deserialized"""
        original = Run(source="test_roundtrip", component="comp")
        json_str = original.to_json()
        restored = Run.from_json(json_str)

        assert restored.source == original.source
        assert restored.component == original.component
