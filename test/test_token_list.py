"""
Ibutsu API

A system to store and query test results

The version of the OpenAPI document: 2.8.3
Generated by OpenAPI Generator (https://openapi-generator.tech)

Do not edit the class manually.
"""

import json
from uuid import uuid4

from ibutsu_client.models.pagination import Pagination
from ibutsu_client.models.token import Token
from ibutsu_client.models.token_list import TokenList


class TestTokenList:
    """TokenList model tests"""

    def test_creation_empty(self):
        model = TokenList()
        assert model.tokens is None
        assert model.pagination is None

    def test_creation_full(self):
        uid = uuid4()
        item = Token(name="t1", token="abc", id=uid, user_id=uid)
        pagination = Pagination(page=1)
        model = TokenList(tokens=[item], pagination=pagination)
        assert len(model.tokens) == 1
        assert model.pagination.page == 1

    def test_to_dict(self):
        uid = uuid4()
        item = Token(name="t1", token="abc", id=uid, user_id=uid)
        model = TokenList(tokens=[item])
        data = model.to_dict()
        assert "tokens" in data
        assert len(data["tokens"]) == 1

    def test_to_dict_with_pagination(self):
        uid = uuid4()
        item = Token(name="t1", token="abc", id=uid, user_id=uid)
        pagination = Pagination(page=1)
        model = TokenList(tokens=[item], pagination=pagination)
        data = model.to_dict()
        assert "pagination" in data
        assert data["pagination"]["page"] == 1

    def test_to_json(self):
        uid = uuid4()
        item = Token(name="t1", token="abc", id=uid, user_id=uid)
        model = TokenList(tokens=[item])
        json_str = model.to_json()
        data = json.loads(json_str)
        assert len(data["tokens"]) == 1

    def test_from_dict(self):
        uid = str(uuid4())
        item_dict = {"name": "t1", "token": "abc", "id": uid, "user_id": uid}
        data = {"tokens": [item_dict], "pagination": {"page": 2}}
        model = TokenList.from_dict(data)
        assert len(model.tokens) == 1
        assert model.pagination.page == 2

    def test_from_json(self):
        uid = str(uuid4())
        json_str = f'{{"tokens": [{{"name": "t1", "token": "abc", "id": "{uid}", "user_id": "{uid}"}}], "pagination": {{"page": 3}}}}'
        model = TokenList.from_json(json_str)
        assert len(model.tokens) == 1

    def test_multiple_items(self):
        uid1 = uuid4()
        uid2 = uuid4()
        i1 = Token(name="t1", token="abc", id=uid1, user_id=uid1)
        i2 = Token(name="t2", token="xyz", id=uid2, user_id=uid2)
        model = TokenList(tokens=[i1, i2])
        data = model.to_dict()
        assert len(data["tokens"]) == 2

    def test_roundtrip_json(self):
        uid = uuid4()
        item = Token(name="t1", token="abc", id=uid, user_id=uid)
        original = TokenList(tokens=[item])
        json_str = original.to_json()
        restored = TokenList.from_json(json_str)
        assert len(restored.tokens) == 1
        assert restored.tokens[0].id == original.tokens[0].id

    def test_to_str(self):
        model = TokenList()
        s = model.to_str()
        assert isinstance(s, str)

    def test_from_dict_none(self):
        model = TokenList.from_dict(None)
        assert model is None

    def test_from_dict_non_dict(self):
        uid = uuid4()
        item = Token(name="t1", token="abc", id=uid, user_id=uid)
        orig = TokenList(tokens=[item])
        model = TokenList.from_dict(orig)
        assert len(model.tokens) == 1

    def test_list_none_values_excluded(self):
        model = TokenList(tokens=[])
        data = model.to_dict()
        assert "tokens" in data
        assert "pagination" not in data
