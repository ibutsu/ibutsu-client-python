"""
Ibutsu API

A system to store and query test results

The version of the OpenAPI document: 2.8.3
Generated by OpenAPI Generator (https://openapi-generator.tech)

Do not edit the class manually.
"""

import pytest

from ibutsu_client.api.widget_config_api import WidgetConfigApi
from ibutsu_client.exceptions import NotFoundException, ServiceException
from ibutsu_client.models.widget_config import WidgetConfig
from ibutsu_client.models.widget_config_list import WidgetConfigList
from test.utils import sample_pagination_data, sample_widget_config_data


class TestWidgetConfigApi:
    """WidgetConfigApi comprehensive tests"""

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": sample_widget_config_data(widget="result-summary", weight=0),
                "status": 201,
            }
        ],
        indirect=True,
    )
    def test_add_widget_config_success(self, mocker, create_mock_response):
        """Test case for add_widget_config - successfully create a widget config"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_config = WidgetConfig(type="widget", widget="result-summary", weight=0, params={})
        result = api.add_widget_config(widget_config=widget_config)

        assert isinstance(result, WidgetConfig)
        assert result.widget == "result-summary"
        assert result.weight == 0
        api.api_client.call_api.assert_called_once()

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": sample_widget_config_data(
                    widget="result-aggregation",
                    weight=5,
                    params={"filter": "result:passed", "chart_type": "bar"},
                ),
                "status": 201,
            }
        ],
        indirect=True,
    )
    def test_add_widget_config_with_params(self, mocker, create_mock_response):
        """Test case for add_widget_config with widget parameters"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        params = {"filter": "result:passed", "chart_type": "bar"}
        widget_config = WidgetConfig(
            type="widget", widget="result-aggregation", weight=5, params=params
        )
        result = api.add_widget_config(widget_config=widget_config)

        assert isinstance(result, WidgetConfig)
        assert result.params == params

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": {"error": "unauthorized"}, "status": 401}],
        indirect=True,
    )
    def test_add_widget_config_unauthorized(self, mocker, create_mock_response):
        """Test case for add_widget_config without authentication"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        with pytest.raises((ServiceException, Exception)):
            api.add_widget_config(widget_config=widget_config)

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": sample_widget_config_data(), "status": 201}],
        indirect=True,
    )
    def test_add_widget_config_with_http_info(self, mocker, create_mock_response):
        """Test case for add_widget_config_with_http_info"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        result = api.add_widget_config_with_http_info(widget_config=widget_config)

        assert result.status_code == 201
        assert isinstance(result.data, WidgetConfig)

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": {}, "status": 204}],
        indirect=True,
    )
    def test_delete_widget_config_success(self, mocker, create_mock_response):
        """Test case for delete_widget_config - successfully delete a widget"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        api.delete_widget_config(id=widget_id)

        # 204 No Content typically returns None
        api.api_client.call_api.assert_called_once()

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": {"error": "not found"}, "status": 404}],
        indirect=True,
    )
    def test_delete_widget_config_not_found(self, mocker, create_mock_response):
        """Test case for delete_widget_config with non-existent widget"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        with pytest.raises(NotFoundException):
            api.delete_widget_config(id=widget_id)

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": {}, "status": 204}],
        indirect=True,
    )
    def test_delete_widget_config_with_http_info(self, mocker, create_mock_response):
        """Test case for delete_widget_config_with_http_info"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        result = api.delete_widget_config_with_http_info(id=widget_id)

        assert result.status_code == 204

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": sample_widget_config_data(widget="jenkins-heatmap"),
                "status": 200,
            }
        ],
        indirect=True,
    )
    def test_get_widget_config_success(self, mocker, create_mock_response):
        """Test case for get_widget_config - retrieve a single widget config"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        result = api.get_widget_config(id=widget_id)

        assert isinstance(result, WidgetConfig)
        assert result.widget == "jenkins-heatmap"

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": {"error": "not found"}, "status": 404}],
        indirect=True,
    )
    def test_get_widget_config_not_found(self, mocker, create_mock_response):
        """Test case for get_widget_config with non-existent widget"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        with pytest.raises(NotFoundException):
            api.get_widget_config(id=widget_id)

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": sample_widget_config_data(), "status": 200}],
        indirect=True,
    )
    def test_get_widget_config_with_http_info(self, mocker, create_mock_response):
        """Test case for get_widget_config_with_http_info"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        result = api.get_widget_config_with_http_info(id=widget_id)

        assert result.status_code == 200
        assert isinstance(result.data, WidgetConfig)

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": {
                    "widgets": [
                        sample_widget_config_data(widget="result-summary", weight=0),
                        sample_widget_config_data(widget="jenkins-heatmap", weight=1),
                    ],
                    "pagination": sample_pagination_data(total_items=2),
                },
                "status": 200,
            }
        ],
        indirect=True,
    )
    def test_get_widget_config_list_success(self, mocker, create_mock_response):
        """Test case for get_widget_config_list - retrieve list of widget configs"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        result = api.get_widget_config_list()

        assert isinstance(result, WidgetConfigList)
        assert len(result.widgets) == 2

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": {
                    "widgets": [sample_widget_config_data()],
                    "pagination": sample_pagination_data(total_items=1),
                },
                "status": 200,
            }
        ],
        indirect=True,
    )
    def test_get_widget_config_list_with_filters(self, mocker, create_mock_response):
        """Test case for get_widget_config_list with filter parameters"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        result = api.get_widget_config_list(filter=["widget_type=result-summary"])

        assert isinstance(result, WidgetConfigList)
        api.api_client.call_api.assert_called_once()

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": {
                    "widgets": [],
                    "pagination": sample_pagination_data(total_items=0),
                },
                "status": 200,
            }
        ],
        indirect=True,
    )
    def test_get_widget_config_list_empty(self, mocker, create_mock_response):
        """Test case for get_widget_config_list with no widgets"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        result = api.get_widget_config_list()

        assert isinstance(result, WidgetConfigList)
        assert len(result.widgets) == 0

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": {
                    "widgets": [],
                    "pagination": sample_pagination_data(),
                },
                "status": 200,
            }
        ],
        indirect=True,
    )
    def test_get_widget_config_list_with_http_info(self, mocker, create_mock_response):
        """Test case for get_widget_config_list_with_http_info"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        result = api.get_widget_config_list_with_http_info()

        assert result.status_code == 200
        assert isinstance(result.data, WidgetConfigList)

    @pytest.mark.parametrize(
        "create_mock_response",
        [
            {
                "data": sample_widget_config_data(widget="result-summary", weight=10),
                "status": 200,
            }
        ],
        indirect=True,
    )
    def test_update_widget_config_success(self, mocker, create_mock_response):
        """Test case for update_widget_config - successfully update a widget config"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="result-summary", weight=10)
        result = api.update_widget_config(id=widget_id, widget_config=widget_config)

        assert isinstance(result, WidgetConfig)
        assert result.weight == 10

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": {"error": "not found"}, "status": 404}],
        indirect=True,
    )
    def test_update_widget_config_not_found(self, mocker, create_mock_response):
        """Test case for update_widget_config with non-existent widget"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        with pytest.raises(NotFoundException):
            api.update_widget_config(id=widget_id, widget_config=widget_config)

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": sample_widget_config_data(), "status": 200}],
        indirect=True,
    )
    def test_update_widget_config_with_http_info(self, mocker, create_mock_response):
        """Test case for update_widget_config_with_http_info"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="test", weight=5)
        result = api.update_widget_config_with_http_info(id=widget_id, widget_config=widget_config)

        assert result.status_code == 200
        assert isinstance(result.data, WidgetConfig)

    @pytest.mark.parametrize(
        "create_mock_response",
        [{"data": {"error": "internal error"}, "status": 500}],
        indirect=True,
    )
    def test_update_widget_config_server_error(self, mocker, create_mock_response):
        """Test case for update_widget_config with server error"""
        api = WidgetConfigApi()
        mocker.patch.object(api.api_client, "call_api", return_value=create_mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        with pytest.raises(ServiceException):
            api.update_widget_config(id=widget_id, widget_config=widget_config)
