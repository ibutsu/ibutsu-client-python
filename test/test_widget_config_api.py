"""
Ibutsu API

A system to store and query test results

The version of the OpenAPI document: 2.8.3
Generated by OpenAPI Generator (https://openapi-generator.tech)

Do not edit the class manually.
"""

import pytest

from ibutsu_client.api.widget_config_api import WidgetConfigApi
from ibutsu_client.exceptions import NotFoundException, ServiceException
from ibutsu_client.models.widget_config import WidgetConfig
from ibutsu_client.models.widget_config_list import WidgetConfigList
from test import create_mock_response


class TestWidgetConfigApi:
    """WidgetConfigApi comprehensive tests"""

    def test_add_widget_config_success(self, mocker, sample_widget_config_data):
        """Test case for add_widget_config - successfully create a widget config"""
        api = WidgetConfigApi()
        widget_data = sample_widget_config_data(widget="result-summary", weight=0)
        mock_response = create_mock_response(widget_data, status=201)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_config = WidgetConfig(type="widget", widget="result-summary", weight=0, params={})
        result = api.add_widget_config(widget_config=widget_config)

        assert isinstance(result, WidgetConfig)
        assert result.widget == "result-summary"
        assert result.weight == 0
        api.api_client.call_api.assert_called_once()

    def test_add_widget_config_with_params(self, mocker, sample_widget_config_data):
        """Test case for add_widget_config with widget parameters"""
        api = WidgetConfigApi()
        params = {"filter": "result:passed", "chart_type": "bar"}
        widget_data = sample_widget_config_data(
            widget="result-aggregation", weight=5, params=params
        )
        mock_response = create_mock_response(widget_data, status=201)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_config = WidgetConfig(
            type="widget", widget="result-aggregation", weight=5, params=params
        )
        result = api.add_widget_config(widget_config=widget_config)

        assert isinstance(result, WidgetConfig)
        assert result.params == params

    def test_add_widget_config_unauthorized(self, mocker):
        """Test case for add_widget_config without authentication"""
        api = WidgetConfigApi()
        mock_response = create_mock_response({"error": "unauthorized"}, status=401)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        with pytest.raises((ServiceException, Exception)):
            api.add_widget_config(widget_config=widget_config)

    def test_add_widget_config_with_http_info(self, mocker, sample_widget_config_data):
        """Test case for add_widget_config_with_http_info"""
        api = WidgetConfigApi()
        widget_data = sample_widget_config_data()
        mock_response = create_mock_response(widget_data, status=201)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        result = api.add_widget_config_with_http_info(widget_config=widget_config)

        assert result.status_code == 201
        assert isinstance(result.data, WidgetConfig)

    def test_delete_widget_config_success(self, mocker):
        """Test case for delete_widget_config - successfully delete a widget"""
        api = WidgetConfigApi()
        mock_response = create_mock_response({}, status=204)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        api.delete_widget_config(id=widget_id)

        # 204 No Content typically returns None
        api.api_client.call_api.assert_called_once()

    def test_delete_widget_config_not_found(self, mocker):
        """Test case for delete_widget_config with non-existent widget"""
        api = WidgetConfigApi()
        mock_response = create_mock_response({"error": "not found"}, status=404)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        with pytest.raises(NotFoundException):
            api.delete_widget_config(id=widget_id)

    def test_delete_widget_config_with_http_info(self, mocker):
        """Test case for delete_widget_config_with_http_info"""
        api = WidgetConfigApi()
        mock_response = create_mock_response({}, status=204)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        result = api.delete_widget_config_with_http_info(id=widget_id)

        assert result.status_code == 204

    def test_get_widget_config_success(self, mocker, sample_widget_config_data):
        """Test case for get_widget_config - retrieve a single widget config"""
        api = WidgetConfigApi()
        widget_data = sample_widget_config_data(widget="jenkins-heatmap")
        mock_response = create_mock_response(widget_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        result = api.get_widget_config(id=widget_id)

        assert isinstance(result, WidgetConfig)
        assert result.widget == "jenkins-heatmap"

    def test_get_widget_config_not_found(self, mocker):
        """Test case for get_widget_config with non-existent widget"""
        api = WidgetConfigApi()
        mock_response = create_mock_response({"error": "not found"}, status=404)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        with pytest.raises(NotFoundException):
            api.get_widget_config(id=widget_id)

    def test_get_widget_config_with_http_info(self, mocker, sample_widget_config_data):
        """Test case for get_widget_config_with_http_info"""
        api = WidgetConfigApi()
        widget_data = sample_widget_config_data()
        mock_response = create_mock_response(widget_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        result = api.get_widget_config_with_http_info(id=widget_id)

        assert result.status_code == 200
        assert isinstance(result.data, WidgetConfig)

    def test_get_widget_config_list_success(
        self, mocker, sample_widget_config_data, sample_pagination_data
    ):
        """Test case for get_widget_config_list - retrieve list of widget configs"""
        api = WidgetConfigApi()
        widget1 = sample_widget_config_data(widget="result-summary", weight=0)
        widget2 = sample_widget_config_data(widget="jenkins-heatmap", weight=1)
        pagination = sample_pagination_data(total_items=2)

        response_data = {
            "widgets": [widget1, widget2],
            "pagination": pagination,
        }
        mock_response = create_mock_response(response_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        result = api.get_widget_config_list()

        assert isinstance(result, WidgetConfigList)
        assert len(result.widgets) == 2

    def test_get_widget_config_list_with_filters(
        self, mocker, sample_widget_config_data, sample_pagination_data
    ):
        """Test case for get_widget_config_list with filter parameters"""
        api = WidgetConfigApi()
        widget1 = sample_widget_config_data()
        pagination = sample_pagination_data(total_items=1)

        response_data = {"widgets": [widget1], "pagination": pagination}
        mock_response = create_mock_response(response_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        result = api.get_widget_config_list(filter=["widget_type=result-summary"])

        assert isinstance(result, WidgetConfigList)
        api.api_client.call_api.assert_called_once()

    def test_get_widget_config_list_empty(self, mocker, sample_pagination_data):
        """Test case for get_widget_config_list with no widgets"""
        api = WidgetConfigApi()
        pagination = sample_pagination_data(total_items=0)
        response_data = {"widgets": [], "pagination": pagination}
        mock_response = create_mock_response(response_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        result = api.get_widget_config_list()

        assert isinstance(result, WidgetConfigList)
        assert len(result.widgets) == 0

    def test_get_widget_config_list_with_http_info(self, mocker, sample_pagination_data):
        """Test case for get_widget_config_list_with_http_info"""
        api = WidgetConfigApi()
        pagination = sample_pagination_data()
        response_data = {"widgets": [], "pagination": pagination}
        mock_response = create_mock_response(response_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        result = api.get_widget_config_list_with_http_info()

        assert result.status_code == 200
        assert isinstance(result.data, WidgetConfigList)

    def test_update_widget_config_success(self, mocker, sample_widget_config_data):
        """Test case for update_widget_config - successfully update a widget config"""
        api = WidgetConfigApi()
        updated_data = sample_widget_config_data(widget="result-summary", weight=10)
        mock_response = create_mock_response(updated_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="result-summary", weight=10)
        result = api.update_widget_config(id=widget_id, widget_config=widget_config)

        assert isinstance(result, WidgetConfig)
        assert result.weight == 10

    def test_update_widget_config_not_found(self, mocker):
        """Test case for update_widget_config with non-existent widget"""
        api = WidgetConfigApi()
        mock_response = create_mock_response({"error": "not found"}, status=404)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        with pytest.raises(NotFoundException):
            api.update_widget_config(id=widget_id, widget_config=widget_config)

    def test_update_widget_config_with_http_info(self, mocker, sample_widget_config_data):
        """Test case for update_widget_config_with_http_info"""
        api = WidgetConfigApi()
        widget_data = sample_widget_config_data()
        mock_response = create_mock_response(widget_data, status=200)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="test", weight=5)
        result = api.update_widget_config_with_http_info(id=widget_id, widget_config=widget_config)

        assert result.status_code == 200
        assert isinstance(result.data, WidgetConfig)

    def test_update_widget_config_server_error(self, mocker):
        """Test case for update_widget_config with server error"""
        api = WidgetConfigApi()
        mock_response = create_mock_response({"error": "internal error"}, status=500)
        mocker.patch.object(api.api_client, "call_api", return_value=mock_response)

        widget_id = "550e8400-e29b-41d4-a716-446655440000"
        widget_config = WidgetConfig(type="widget", widget="test", weight=0)
        with pytest.raises(ServiceException):
            api.update_widget_config(id=widget_id, widget_config=widget_config)
